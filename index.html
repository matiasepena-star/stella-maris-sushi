<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Sushi Stella Maris</title>

<style>
  :root{
    --bg:#0b0b0c;
    --panel:#101114;
    --card:#15161a;
    --line:#262830;
    --text:#f3f3f3;
    --muted:#b7b7b7;
    --gold:#caa76a;
    --gold2:#8f6f3f;
    --shadow: 0 18px 55px rgba(0,0,0,.55);
    --radius:18px;

    /* Tama√±os por pesta√±a */
    --imgH-combos: 170px;
    --imgH-extras: 150px;
    --imgH-rolls: 130px;
  }

  *{box-sizing:border-box}
  body{
    margin:0;
    font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text","Segoe UI",Roboto,Arial,sans-serif;
    background:
      radial-gradient(1200px 700px at 50% -10%, rgba(202,167,106,.18), transparent 55%),
      radial-gradient(900px 550px at 20% 20%, rgba(255,255,255,.06), transparent 52%),
      var(--bg);
    color:var(--text);
  }

  /* Header fijo */
  header{
    position:fixed; top:0; left:0; right:0;
    z-index:1000;
    background: rgba(15,16,18,.92);
    backdrop-filter: blur(12px);
    border-bottom:1px solid rgba(255,255,255,.08);
    padding:14px 14px 10px;
  }
  .wrap{max-width:920px; margin:0 auto;}
  .brandRow{display:flex; align-items:center; gap:12px;}
  .logo{
    width:40px; height:40px; border-radius:14px;
    display:grid; place-items:center;
    color:var(--gold);
    background:
      radial-gradient(circle at 30% 30%, rgba(255,255,255,.14), transparent 40%),
      linear-gradient(135deg, rgba(202,167,106,.28), rgba(202,167,106,.08));
    border:1px solid rgba(202,167,106,.25);
    user-select:none;
  }
  h1{margin:0; font-size:18px; letter-spacing:.2px; font-weight:1000;}

  .tabs{
    margin-top:10px;
    display:flex;
    gap:10px;
    flex-wrap:nowrap;              /* una sola l√≠nea */
    overflow:hidden;
  }
  .tab{
    flex:1;                         /* entran en una l√≠nea */
    text-align:center;
    padding:10px 12px;
    border-radius:14px;
    cursor:pointer;
    font-size:13px;
    font-weight:900;
    color: rgba(255,255,255,.85);
    background: rgba(255,255,255,.04);
    border:1px solid rgba(255,255,255,.10);
    user-select:none;
    transition: transform .08s ease, background .15s ease, border-color .15s ease, box-shadow .12s ease;
    -webkit-tap-highlight-color: transparent;
  }
  .tab:active{
    transform: translateY(2px) scale(.985);
    box-shadow: inset 0 0 0 999px rgba(0,0,0,.18);
  }
  .tab.active{
    background: rgba(202,167,106,.16);
    border-color: rgba(202,167,106,.35);
    color:#fff;
  }

  /* Contenido */
  .content{
    max-width:920px;
    margin:0 auto;
    padding: 112px 14px 156px; /* deja lugar a header + footer */
  }

  .topHint{
    margin: 10px 2px 12px;
    font-size: 13px;
    color: rgba(255,255,255,.78);
  }
  .topHint b{color:var(--gold); font-weight:1000;}

  .sectionTitle{
    margin: 8px 2px 10px;
    color: var(--gold);
    letter-spacing:.25em;
    font-weight:1000;
    font-size: 12px;
    text-transform: uppercase;
  }

  /* Grilla base (se redefine por tab con clases) */
  .grid{
    display:grid;
    gap:14px;
  }
  .grid.rolls{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
  .grid.combos{ grid-template-columns: 1fr; }
  .grid.extras{ grid-template-columns: 1fr; }

  /* En pantallas grandes, rolls puede crecer a 3 si quer√©s (opcional) */
  @media (min-width: 980px){
    .grid.rolls{ grid-template-columns: repeat(3, minmax(0, 1fr)); }
  }
  /* En m√≥vil, rolls sigue 2 columnas (como pediste) */
  @media (max-width: 420px){
    .grid.rolls{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
  }

  .card{
    background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
    border:1px solid rgba(255,255,255,.08);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    overflow:hidden;
    position:relative;
  }

  /* Imagen (A: sin recorte) */
  .imgBox{
    width:100%;
    background:
      radial-gradient(220px 140px at 20% 20%, rgba(202,167,106,.22), transparent 60%),
      radial-gradient(220px 140px at 80% 0%, rgba(255,255,255,.06), transparent 60%),
      rgba(0,0,0,.35);
    border-bottom:1px solid rgba(255,255,255,.06);
    position:relative;
    display:flex;
    align-items:center;
    justify-content:center;
    overflow:hidden;
  }
  .imgBox.combos{ height: var(--imgH-combos); }
  .imgBox.extras{ height: var(--imgH-extras); }
  .imgBox.rolls{ height: var(--imgH-rolls); }

  .imgBox img{
    width:100%;
    height:100%;
    object-fit: contain; /* A: sin recorte */
    object-position:center;
    display:block;
  }

  .zoomHint{
    position:absolute;
    top:10px;
    left:50%;
    transform:translateX(-50%);
    padding:7px 12px;
    border-radius:999px;
    background: rgba(0,0,0,.55);
    border:1px solid rgba(255,255,255,.12);
    color: rgba(255,255,255,.88);
    font-weight:900;
    font-size:12px;
    letter-spacing:.02em;
    user-select:none;
    pointer-events:none;
  }

  .priceTag{
    position:absolute;
    top:12px; right:12px;
    background: rgba(0,0,0,.55);
    border:1px solid rgba(255,255,255,.10);
    padding:7px 10px;
    border-radius:999px;
    font-weight:1000;
    letter-spacing:.3px;
  }

  .body{
    padding: 12px 14px 14px;
  }
  .name{margin:0; font-size:16px; font-weight:1000; line-height:1.15;}
  .meta{margin-top:6px; font-size:12.5px; color:var(--muted); line-height:1.25;}
  .meta b{color: rgba(255,255,255,.90); font-weight:1000;}
  .list{
    margin:10px 0 0;
    padding-left: 18px;
    color: rgba(255,255,255,.78);
    font-size: 12.5px;
    line-height:1.35;
  }

  .bottomRow{
    margin-top:12px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:10px;
    padding-top: 12px;
    border-top: 1px solid rgba(255,255,255,.08);
  }

  .qty{
    display:flex; align-items:center; gap:10px;
    font-size:12.5px;
    color: var(--muted);
    font-weight:900;
  }
  .qtyPill{
    padding:6px 10px;
    border-radius:999px;
    border:1px solid rgba(202,167,106,.26);
    background: rgba(202,167,106,.10);
    color:#fff;
    min-width:50px;
    text-align:center;
    font-weight:1000;
  }

  .btns{display:flex; gap:10px;}
  .btn{
    border:none;
    cursor:pointer;
    user-select:none;
    font-weight:1000;
    padding:12px 14px;
    border-radius: 14px;
    background: rgba(255,255,255,.06);
    border:1px solid rgba(255,255,255,.12);
    color:#fff;
    transition: transform .08s ease, filter .15s ease, background .15s ease, box-shadow .12s ease;
    -webkit-tap-highlight-color: transparent;
  }

  /* M√°s ‚Äúpresionado‚Äù */
  .btn:active{
    transform: translateY(3px) scale(.975);
    filter: brightness(.92);
    box-shadow:
      inset 0 0 0 999px rgba(0,0,0,.18),
      inset 0 10px 18px rgba(0,0,0,.35);
  }

  .btn.add{
    background: linear-gradient(180deg, rgba(202,167,106,.95), rgba(143,111,63,.95));
    border:1px solid rgba(202,167,106,.55);
    color:#1a140b;
  }
  .btn.minus{
    background: rgba(255,255,255,.04);
  }

  /* Footer fijo */
  .footer{
    position:fixed; left:0; right:0; bottom:0;
    z-index:1000;
    background: rgba(10,10,12,.90);
    backdrop-filter: blur(12px);
    border-top:1px solid rgba(255,255,255,.10);
    padding:10px 12px;
  }
  .footerInner{
    max-width:920px;
    margin:0 auto;
    display:flex;
    gap:10px;
    align-items:stretch;
    justify-content:space-between;
    flex-wrap:wrap;
  }
  .totals{
    flex:1;
    display:flex;
    flex-direction:column;
    gap:6px;
    padding:10px 12px;
    border-radius: 14px;
    background: rgba(255,255,255,.04);
    border:1px solid rgba(255,255,255,.10);
    min-width: 240px;
  }
  .totals .big{font-weight:1000; font-size:15px;}
  .totals .small{color:var(--muted); font-weight:900; font-size:12.5px;}
  .extrasLine{
    color: rgba(255,255,255,.78);
    font-size: 12.5px;
    font-weight:800;
    line-height:1.25;
    white-space: nowrap;
    overflow:hidden;
    text-overflow: ellipsis;
  }
  .extrasLine b{color:var(--gold); font-weight:1000;}

  .footerBtns{
    display:flex;
    gap:10px;
    align-items:stretch;
    flex-wrap:wrap;
    min-width: 260px;
  }
  .btnGhost{
    padding:12px 14px;
    border-radius: 14px;
    background: rgba(255,255,255,.04);
    border:1px solid rgba(255,255,255,.10);
    color:#fff;
    font-weight:1000;
    cursor:pointer;
    transition: transform .08s ease, filter .15s ease, box-shadow .12s ease;
    -webkit-tap-highlight-color: transparent;
    min-width: 110px;
  }
  .btnGhost:active{
    transform: translateY(3px) scale(.975);
    filter:brightness(.92);
    box-shadow:
      inset 0 0 0 999px rgba(0,0,0,.18),
      inset 0 10px 18px rgba(0,0,0,.35);
  }
  .btnWA{
    padding:12px 16px;
    border-radius: 14px;
    background: linear-gradient(180deg, rgba(202,167,106,.95), rgba(143,111,63,.95));
    border:1px solid rgba(202,167,106,.55);
    color:#1a140b;
    font-weight:1100;
    cursor:pointer;
    text-align:center;
    transition: transform .08s ease, filter .15s ease, box-shadow .12s ease;
    -webkit-tap-highlight-color: transparent;
    flex:1;
    min-width: 180px;
  }
  .btnWA:active{
    transform: translateY(3px) scale(.975);
    filter:brightness(.92);
    box-shadow:
      inset 0 0 0 999px rgba(0,0,0,.12),
      inset 0 10px 18px rgba(0,0,0,.30);
  }

  @media (max-width:520px){
    .footerBtns{width:100%;}
    .totals{min-width: 100%;}
  }

  /* Modal para agrandar imagen */
  .modal{
    position:fixed; inset:0;
    background: rgba(0,0,0,.78);
    backdrop-filter: blur(6px);
    z-index:2000;
    display:none;
    align-items:center;
    justify-content:center;
    padding:16px;
  }
  .modal.open{display:flex;}
  .modalBox{
    max-width: 980px;
    width:100%;
    border-radius: 18px;
    overflow:hidden;
    border:1px solid rgba(255,255,255,.12);
    background: rgba(10,10,12,.92);
    box-shadow: 0 30px 90px rgba(0,0,0,.65);
    position:relative;
  }
  .modalImg{
    width:100%;
    height: 72vh;
    object-fit: contain; /* sin recorte */
    background: rgba(0,0,0,.65);
    display:block;
  }
  .modalTop{
    position:absolute; top:10px; left:10px; right:10px;
    display:flex; justify-content:space-between; gap:10px;
    pointer-events:none;
  }
  .modalPill{
    pointer-events:none;
    padding:8px 12px;
    border-radius:999px;
    background: rgba(0,0,0,.55);
    border:1px solid rgba(255,255,255,.12);
    color:#fff;
    font-weight:1000;
    font-size:12px;
  }
  .modalClose{
    pointer-events:auto;
    cursor:pointer;
    padding:8px 12px;
    border-radius:999px;
    background: rgba(0,0,0,.70);
    border:1px solid rgba(255,255,255,.14);
    color:#fff;
    font-weight:1100;
    font-size:12px;
    -webkit-tap-highlight-color: transparent;
  }
  .modalClose:active{
    transform: translateY(2px);
    filter:brightness(.9);
  }
</style>
</head>

<body>
<header>
  <div class="wrap">
    <div class="brandRow">
      <div class="logo">‚ú¶</div>
      <div>
        <h1>Sushi Stella Maris</h1>
      </div>
    </div>

    <div class="tabs">
      <div class="tab active" onclick="setTab('combos', this)">Combos</div>
      <div class="tab" onclick="setTab('rolls', this)">Rolls</div>
      <div class="tab" onclick="setTab('extras', this)">Salsas</div>
    </div>
  </div>
</header>

<div class="content" id="content"></div>

<div class="footer">
  <div class="footerInner">
    <div class="totals">
      <div class="big" id="totalMoney">Total: $0</div>
      <div class="small" id="totalPieces">Total de piezas: 0</div>
      <div class="extrasLine" id="extrasLine"><b>Salsas/Adicionales:</b> ‚Äî</div>
    </div>

    <div class="footerBtns">
      <button class="btnGhost" id="btnClear">Vaciar</button>
      <button class="btnWA" id="btnWA">Confirmar por WhatsApp</button>
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal" id="modal">
  <div class="modalBox">
    <div class="modalTop">
      <div class="modalPill" id="modalTitle">‚Äî</div>
      <div class="modalClose" id="modalClose">Cerrar ‚úï</div>
    </div>
    <img class="modalImg" id="modalImg" alt="Foto">
  </div>
</div>

<script>
  /* WhatsApp */
  const WA = "5491164194866";

  const fmtMoney = (n) => {
    const x = Math.round(Number(n)||0);
    return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
  };

  let activeTab = "combos";
  const cart = {}; // id -> qty

  /*
    IM√ÅGENES (GitHub):
    - philadelphia.PNG
    - buenos-aires.PNG
    - guacamole.PNG
  */

  const MENU = [
    /* ===== COMBOS ===== */
    {
      id:"combo10", tab:"combos",
      name:"Combo 10 piezas",
      pieces:10,
      price:16000,
      includesRule:"Incluye: Soja fija (x1) + 1 a elecci√≥n (seg√∫n reglas).",
      composition:["4 Philadelphia","3 New York","3 California"],
      img:""
    },
    {
      id:"combo15", tab:"combos",
      name:"Combo 15 piezas",
      pieces:15,
      price:22000,
      includesRule:"Incluye: Soja fija (x1) + 1 a elecci√≥n (seg√∫n reglas).",
      composition:["5 New York","5 California","5 Buenos Aires"],
      img:""
    },
    {
      id:"combo20", tab:"combos",
      name:"Combo 20 piezas",
      pieces:20,
      price:28000,
      includesRule:"Incluye: Soja fija (x1) + 1 a elecci√≥n (seg√∫n reglas).",
      composition:["Mayor variedad de rolls (a definir)"],
      img:""
    },
    {
      id:"combo30", tab:"combos",
      name:"Combo 30 piezas",
      pieces:30,
      price:40000,
      includesRule:"Incluye: Soja fija (x1) + 1 a elecci√≥n.",
      composition:["Amplia variedad de rolls (a definir)"],
      img:""
    },
    {
      id:"combo40", tab:"combos",
      name:"Combo 40 piezas",
      pieces:40,
      price:0,
      includesRule:"Incluye: Soja fija (x2) + 1 a elecci√≥n.",
      composition:["(Definir composici√≥n)"],
      img:""
    },
    {
      id:"combo50", tab:"combos",
      name:"Combo 50 piezas",
      pieces:50,
      price:0,
      includesRule:"Incluye: Soja fija (x2) + 2 a elecci√≥n.",
      composition:["(Definir composici√≥n)"],
      img:""
    },

    /* ===== ROLLS (x5) ===== */
    { id:"philadelphia", tab:"rolls", name:"Philadelphia", pieces:5, price:9000, desc:"Salm√≥n fresco + queso crema.", img:"philadelphia.PNG" },
    { id:"buenos_aires", tab:"rolls", name:"Buenos Aires", pieces:5, price:11000, desc:"Langostino + queso + palta, con salsa BA.", img:"buenos-aires.PNG" },
    { id:"guacamole_roll", tab:"rolls", name:"Guacamole", pieces:5, price:10500, desc:"Salm√≥n + queso con topping de guacamole.", img:"guacamole.PNG" },

    /* (dej√© ejemplos ‚Äî despu√©s met√©s descripciones reales) */
    { id:"newyork", tab:"rolls", name:"New York", pieces:5, price:9000, desc:"Salm√≥n y palta.", img:"" },
    { id:"california", tab:"rolls", name:"California", pieces:5, price:8500, desc:"Kani kama y palta.", img:"" },
    { id:"alaska", tab:"rolls", name:"Alaska", pieces:5, price:9500, desc:"Salm√≥n, queso y palta.", img:"" },
    { id:"alaska_ahumado", tab:"rolls", name:"Alaska Ahumado", pieces:5, price:10000, desc:"Salm√≥n ahumado, queso y palta.", img:"" },
    { id:"crazy", tab:"rolls", name:"Crazy", pieces:5, price:10500, desc:"Palta y queso, envuelto en salm√≥n.", img:"" },
    { id:"avocado", tab:"rolls", name:"Avocado", pieces:5, price:9000, desc:"Salm√≥n y queso rodeado de palta.", img:"" },
    { id:"vegetariano", tab:"rolls", name:"Vegetariano", pieces:5, price:7500, desc:"Zanahoria, palta y queso.", img:"" },
    { id:"tamago_roll", tab:"rolls", name:"Tamago", pieces:5, price:8000, desc:"Huevo dulce con salm√≥n y queso.", img:"" },

    /* Makis (x5) */
    { id:"maki_salmon", tab:"rolls", name:"Maki de salm√≥n", pieces:5, price:8500, desc:"Salm√≥n envuelto en arroz y alga.", img:"" },
    { id:"maki_salmon_ahumado", tab:"rolls", name:"Maki de salm√≥n ahumado", pieces:5, price:9500, desc:"Salm√≥n ahumado.", img:"" },
    { id:"maki_atun", tab:"rolls", name:"Maki de at√∫n", pieces:5, price:8000, desc:"At√∫n suave envuelto en arroz y alga.", img:"" },
    { id:"maki_veggie", tab:"rolls", name:"Maki veggie", pieces:5, price:7500, desc:"Zanahoria, palta, mango y queso.", img:"" },

    /* Niguiris (x5) */
    { id:"niguiri_salmon", tab:"rolls", name:"Niguiri de salm√≥n", pieces:5, price:8500, desc:"Arroz y salm√≥n fresco.", img:"" },
    { id:"niguiri_salmon_ah", tab:"rolls", name:"Niguiri de salm√≥n ahumado", pieces:5, price:9500, desc:"Arroz con salm√≥n ahumado.", img:"" },
    { id:"keki_niguiri", tab:"rolls", name:"KeKi", pieces:5, price:10500, desc:"Niguiri de salm√≥n con queso, mango y palta.", img:"" },

    /* Sashimis (x5 cortes) */
    { id:"sashimi_salmon", tab:"rolls", name:"Sashimi de salm√≥n", pieces:5, price:10000, desc:"Cortes de salm√≥n fresco.", img:"" },
    { id:"sashimi_flameado", tab:"rolls", name:"Sashimi de salm√≥n flameado", pieces:5, price:11500, desc:"Salm√≥n sellado al fuego.", img:"" },

    /* ===== SALSAS / ADICIONALES (unidad) ===== */
    { id:"soja", tab:"extras", name:"Salsa de soja", pieces:0, price:850, desc:"Unidad.", img:"" },
    { id:"salsa_ba", tab:"extras", name:"Salsa Buenos Aires", pieces:0, price:1300, desc:"Unidad.", img:"" },
    { id:"mostaza_miel", tab:"extras", name:"Salsa mostaza y miel", pieces:0, price:1300, desc:"Unidad.", img:"" },
    { id:"maracuya", tab:"extras", name:"Salsa maracuy√°", pieces:0, price:1500, desc:"Unidad.", img:"" },

    { id:"guacamole_extra", tab:"extras", name:"Guacamole", pieces:0, price:850, desc:"Unidad.", img:"" },
    { id:"criolla", tab:"extras", name:"Criolla", pieces:0, price:750, desc:"Unidad.", img:"" },
    { id:"jengibre", tab:"extras", name:"Jengibre", pieces:0, price:750, desc:"Unidad.", img:"" },
    { id:"pepino", tab:"extras", name:"Pepino", pieces:0, price:700, desc:"Unidad.", img:"" }
  ];

  const getQty = (id) => cart[id] || 0;

  function haptic() {
    try { if (navigator.vibrate) navigator.vibrate(14); } catch(e){}
  }

  function setTab(tab, el){
    activeTab = tab;
    document.querySelectorAll(".tab").forEach(t => t.classList.remove("active"));
    el.classList.add("active");
    render();
    window.scrollTo({top:0, behavior:"smooth"});
  }

  function add(id){
    cart[id] = (cart[id]||0) + 1;
    haptic();
    updateTotals();
    updateQtyPills();
  }

  function sub(id){
    if (!cart[id]) return;
    cart[id] -= 1;
    if (cart[id] <= 0) delete cart[id];
    haptic();
    updateTotals();
    updateQtyPills();
  }

  function clearCart(){
    if (Object.keys(cart).length === 0) return;
    if (!confirm("¬øVaciar el pedido?")) return;
    for (const k of Object.keys(cart)) delete cart[k];
    updateTotals();
    render();
  }

  function totals(){
    let totalMoney = 0;
    let totalPieces = 0;

    for (const [id, qty] of Object.entries(cart)){
      const item = MENU.find(x => x.id === id);
      if (!item) continue;
      totalMoney += (item.price||0) * qty;
      totalPieces += (item.pieces||0) * qty;
    }
    return { totalMoney, totalPieces };
  }

  function extrasSummary(){
    const extras = Object.entries(cart)
      .map(([id, qty]) => ({ qty, item: MENU.find(x => x.id === id) }))
      .filter(x => x.item && x.item.tab === "extras")
      .sort((a,b) => a.item.name.localeCompare(b.item.name));

    if (!extras.length) return "‚Äî";
    return extras.map(x => `${x.qty}x ${x.item.name}`).join(" ¬∑ ");
  }

  function updateTotals(){
    const { totalMoney, totalPieces } = totals();
    document.getElementById("totalMoney").textContent = `Total: $${fmtMoney(totalMoney)}`;
    document.getElementById("totalPieces").textContent = `Total de piezas: ${totalPieces}`;
    document.getElementById("extrasLine").innerHTML = `<b>Salsas/Adicionales:</b> ${extrasSummary()}`;
  }

  function updateQtyPills(){
    MENU.forEach(item => {
      const pill = document.getElementById("qty-"+item.id);
      if (!pill) return;
      pill.textContent = (getQty(item.id)) + "x";
    });
  }

  function buildMessage(){
    const sushiLines = [];
    const extraLines = [];

    const entries = Object.entries(cart)
      .map(([id, qty]) => ({ qty, item: MENU.find(x => x.id === id) }))
      .filter(x => x.item)
      .sort((a,b) => (a.item.tab + a.item.name).localeCompare(b.item.tab + b.item.name));

    let totalMoney = 0;
    let totalPieces = 0;

    for (const {qty, item} of entries){
      totalMoney += (item.price||0) * qty;

      const itemPieces = (item.pieces||0) * qty;
      totalPieces += itemPieces;

      if (item.pieces > 0) {
        const xBase = item.pieces === 5 ? " x5" : "";
        sushiLines.push(`${qty}x ${item.name}${xBase} ‚Äì ${itemPieces} piezas`);
      } else {
        extraLines.push(`${qty}x ${item.name}`);
      }
    }

    let msg = "";
    msg += "Hola Stella Maris Sushi üç£\n\n";
    msg += "Quiero pedir:\n\n";
    msg += "üç£ Sushi:\n";
    msg += (sushiLines.length ? sushiLines.join("\n") : "‚Äî") + "\n\n";
    if (extraLines.length){
      msg += "ü•£ Salsas y adicionales:\n";
      msg += extraLines.join("\n") + "\n\n";
    }
    msg += `Total de piezas: ${totalPieces}\n`;
    msg += `Total: $${fmtMoney(totalMoney)}\n\n`;
    msg += "Retiro en el local.";

    return msg;
  }

  function sendWA(){
    if (Object.keys(cart).length === 0){
      alert("Agreg√° algo al pedido üôÇ");
      return;
    }
    const msg = buildMessage();
    const url = `https://wa.me/${WA}?text=${encodeURIComponent(msg)}`;
    window.open(url, "_blank");
  }

  /* Modal */
  const modal = document.getElementById("modal");
  const modalImg = document.getElementById("modalImg");
  const modalTitle = document.getElementById("modalTitle");
  const modalClose = document.getElementById("modalClose");

  function openModal(src, title){
    modalImg.src = src;
    modalTitle.textContent = title;
    modal.classList.add("open");
  }
  function closeModal(){
    modal.classList.remove("open");
    modalImg.src = "";
  }
  modalClose.addEventListener("click", closeModal);
  modal.addEventListener("click", (e) => { if (e.target === modal) closeModal(); });

  function cardHTML(item){
    const price = item.price ? `$${fmtMoney(item.price)}` : "‚Äî";
    const qty = getQty(item.id);

    const base =
      item.pieces === 5 ? "x5 piezas" :
      item.pieces > 0 ? `${item.pieces} piezas` :
      "Unidad";

    const imgClass = item.tab; // combos / rolls / extras
    const hasImg = !!item.img;

    const imgBlock = hasImg
      ? `
        <div class="imgBox ${imgClass}" onclick="openModal('${item.img}', '${item.name}')">
          <img src="${item.img}" alt="${item.name}">
          <div class="zoomHint">Tocar para agrandar</div>
        </div>`
      : `
        <div class="imgBox ${imgClass}">
          <div class="zoomHint">Foto (pendiente)</div>
        </div>`;

    const desc = item.tab === "combos"
      ? `<div class="meta"><b>${base}</b> ¬∑ ${item.includesRule || ""}</div>
         ${(item.composition && item.composition.length) ? `<ul class="list">${item.composition.map(x=>`<li>${x}</li>`).join("")}</ul>` : ""}`
      : `<div class="meta"><b>${base}</b> ¬∑ ${item.desc || ""}</div>`;

    return `
      <div class="card">
        <div class="priceTag">${price}</div>
        ${imgBlock}
        <div class="body">
          <p class="name">${item.name}</p>
          ${desc}
          <div class="bottomRow">
            <div class="qty">En tu pedido: <span class="qtyPill" id="qty-${item.id}">${qty}x</span></div>
            <div class="btns">
              <button class="btn minus" onclick="sub('${item.id}')">‚Äì</button>
              <button class="btn add" onclick="add('${item.id}')">Agregar</button>
            </div>
          </div>
        </div>
      </div>
    `;
  }

  function render(){
    const root = document.getElementById("content");
    const items = MENU.filter(x => x.tab === activeTab);

    const title = activeTab === "combos"
      ? "COMBOS"
      : (activeTab === "rolls" ? "ROLLS" : "SALSAS");

    const hint = activeTab === "rolls"
      ? `Cada roll es <b>x5</b>.`
      : (activeTab === "extras" ? `Salsas y adicionales por <b>unidad</b>.` : `Eleg√≠ tu combo y sum√° extras si quer√©s.`);

    const gridClass = activeTab; // combos / rolls / extras

    root.innerHTML = `
      <div class="topHint">${hint}</div>
      <div class="sectionTitle">${title}</div>
      <div class="grid ${gridClass}">
        ${items.map(cardHTML).join("")}
      </div>
    `;

    updateTotals();
    updateQtyPills();
  }

  document.getElementById("btnClear").addEventListener("click", clearCart);
  document.getElementById("btnWA").addEventListener("click", sendWA);

  render();
</script>
</body>
</html>
