<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sushi Stella Maris</title>

  <style>
    :root{
      --bg:#0f0f12;
      --card:#17171c;
      --card2:#1d1d23;
      --text:#f3f3f6;
      --muted:#b8b8c6;
      --line:#2a2a33;
      --gold:#d8b26b;
      --gold2:#b88b3c;
      --shadow: 0 12px 28px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background: radial-gradient(1200px 800px at 20% 10%, rgba(216,178,107,.18), transparent 55%),
                  radial-gradient(900px 700px at 80% 30%, rgba(184,139,60,.12), transparent 55%),
                  var(--bg);
      color:var(--text);
      padding:18px 14px 160px;
    }

    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin-bottom:14px;
    }
    .title{
      font-size:22px;
      font-weight:800;
      letter-spacing:.2px;
    }
    .pill{
      background: rgba(216,178,107,.14);
      border: 1px solid rgba(216,178,107,.28);
      color: var(--gold);
      padding:10px 12px;
      border-radius:999px;
      font-weight:700;
      font-size:14px;
      display:flex;
      align-items:center;
      gap:8px;
      white-space:nowrap;
    }
    .pill small{color:rgba(216,178,107,.85); font-weight:700}

    .tabs{
      display:flex;
      gap:10px;
      margin:10px 0 10px;
      flex-wrap:nowrap; /* una lÃ­nea */
      overflow:hidden;
    }
    .tab{
      flex:1;
      min-width:0;
      text-align:center;
      padding:12px 10px;
      border-radius:14px;
      background: rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.06);
      color: var(--text);
      font-weight:800;
      letter-spacing:.2px;
      user-select:none;
      cursor:pointer;
      transition: .15s ease;
    }
    .tab:active{ transform: scale(.98); }
    .tab.active{
      background: rgba(216,178,107,.16);
      border:1px solid rgba(216,178,107,.35);
      color: var(--gold);
      box-shadow: 0 0 0 1px rgba(216,178,107,.10) inset;
    }

    .hint{
      color: var(--muted);
      font-size:14px;
      margin:8px 2px 10px;
      line-height:1.35;
    }
    .hint b{color:var(--gold)}
    .grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border: 1px solid rgba(255,255,255,.08);
      border-radius:18px;
      overflow:hidden;
      box-shadow: var(--shadow);
      position:relative;
    }

    /* Imagen mÃ¡s chica para que no estire mucho */
    .img-wrap{
      height:150px;
      overflow:hidden;
      background: rgba(255,255,255,.03);
      cursor:pointer;
      position:relative;
    }
    .img-wrap img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
      filter: saturate(1.02) contrast(1.05);
    }
    .img-tag{
      position:absolute;
      top:10px;
      left:10px;
      background: rgba(0,0,0,.45);
      border: 1px solid rgba(255,255,255,.10);
      color: rgba(255,255,255,.85);
      font-size:12px;
      padding:6px 10px;
      border-radius:999px;
      backdrop-filter: blur(6px);
    }

    .card-body{
      padding:12px 12px 14px;
    }
    .card h3{
      margin:0 0 6px;
      font-size:18px;
      font-weight:900;
      display:flex;
      align-items:baseline;
      justify-content:space-between;
      gap:10px;
    }
    .price{
      color: var(--gold);
      font-weight:900;
      white-space:nowrap;
    }
    .desc{
      margin:0 0 12px;
      color: var(--muted);
      font-size:14px;
      line-height:1.25;
      min-height:34px;
    }

    .actions{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }

    .badge{
      background: rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.10);
      color: rgba(255,255,255,.90);
      padding:8px 10px;
      border-radius:999px;
      font-weight:900;
      min-width:52px;
      text-align:center;
    }

    .btn{
      flex:1;
      border:none;
      border-radius:12px;
      padding:12px 14px;
      font-weight:1000;
      font-size:16px;
      cursor:pointer;
      transition:.15s ease;
      background: linear-gradient(135deg, var(--gold), var(--gold2));
      color:#181818;
      box-shadow: 0 8px 18px rgba(216,178,107,.18);
    }
    .btn:active{ transform: scale(.95); }
    .btn.secondary{
      background: rgba(255,255,255,.06);
      color: var(--text);
      border:1px solid rgba(255,255,255,.10);
      box-shadow:none;
    }

    /* Footer fijo */
    .footer{
      position:fixed;
      left:0; right:0; bottom:0;
      background: rgba(15,15,18,.88);
      border-top: 1px solid rgba(255,255,255,.08);
      backdrop-filter: blur(10px);
      padding:12px 14px 16px;
    }
    .footer-row{
      display:flex;
      justify-content:space-between;
      gap:16px;
      align-items:flex-start;
      margin-bottom:10px;
    }
    .totals{
      flex:1;
      color: var(--muted);
      font-size:14px;
      line-height:1.55;
    }
    .totals b{ color: var(--text); }
    .includes{
      flex:1.1;
      color: var(--muted);
      font-size:14px;
      line-height:1.35;
      text-align:left;
    }
    .includes b{ color: var(--text); }
    .selection-line{
      margin-top:6px;
      color: var(--muted);
      font-size:13px;
    }
    .selection-line b{ color: var(--gold); }

    .footer-actions{
      display:flex;
      gap:12px;
    }
    .footer-actions .btn{
      padding:14px 14px;
      border-radius:14px;
      font-size:16px;
    }

    /* Modal imagen */
    .modal{
      display:none;
      position:fixed;
      inset:0;
      background: rgba(0,0,0,.86);
      justify-content:center;
      align-items:center;
      z-index:999;
      padding:16px;
    }
    .modal img{
      max-width:95%;
      max-height:92%;
      border-radius:14px;
      box-shadow: 0 20px 60px rgba(0,0,0,.5);
    }

    /* Toast */
    .toast{
      position:fixed;
      left:50%;
      bottom:130px;
      transform:translateX(-50%);
      background: rgba(0,0,0,.72);
      border:1px solid rgba(255,255,255,.12);
      color: rgba(255,255,255,.92);
      padding:10px 12px;
      border-radius:12px;
      font-size:14px;
      display:none;
      z-index:1000;
      backdrop-filter: blur(8px);
    }

    @media (max-width:360px){
      .grid{ grid-template-columns: 1fr; }
      .img-wrap{ height:160px; }
      .tabs{ gap:8px; }
      .tab{ padding:11px 8px; font-size:14px; }
    }
  </style>
</head>

<body>
  <div class="topbar">
    <div class="title">Sushi Stella Maris</div>
    <div class="pill"><small>Soja incluida</small> âœ“</div>
  </div>

  <div class="tabs">
    <div class="tab active" id="tabCombos" onclick="setTab('combos')">Combos</div>
    <div class="tab" id="tabRolls" onclick="setTab('rolls')">Rolls</div>
    <div class="tab" id="tabSalsas" onclick="setTab('salsas')">Salsas</div>
  </div>

  <div class="hint" id="hint"></div>

  <div class="grid" id="grid"></div>

  <!-- Footer -->
  <div class="footer">
    <div class="footer-row">
      <div class="totals">
        <div>Total piezas: <b id="totalPiezas">0</b></div>
        <div>Total: <b id="totalPrice">$ 0</b></div>
        <div class="selection-line">
          <b>Salsas/Adicionales:</b> <span id="selectedExtras">â€”</span>
        </div>
      </div>

      <div class="includes">
        <div>Incluye:</div>
        <div><b>Wasabi + Pepino + Jengibre + Soja</b></div>
      </div>
    </div>

    <div class="footer-actions">
      <button class="btn secondary" onclick="vaciar()">Vaciar</button>
      <button class="btn" onclick="copiarPedido()">Copiar pedido</button>
    </div>
  </div>

  <!-- Modal imagen -->
  <div id="imageModal" class="modal" onclick="closeImage()">
    <img id="modalImg" alt="imagen ampliada">
  </div>

  <div class="toast" id="toast">Copiado âœ…</div>

  <script>
    // ====== DATA ======
    // (por ahora solo 3 Rolls con tus 3 fotos PNG)
    const rolls = [
      { id:"philadelphia", name:"Philadelphia", price:9000, pieces:5, img:"philadelphia.PNG", desc:"SalmÃ³n fresco + queso crema." },
      { id:"buenos-aires", name:"Buenos Aires", price:11000, pieces:5, img:"buenos-aires.PNG", desc:"Langostino + queso + palta, con salsa BA." },
      { id:"guacamole", name:"Guacamole", price:10500, pieces:5, img:"guacamole.PNG", desc:"SalmÃ³n + queso con topping de guacamole." },
    ];

    // Combos (reglas que me diste)
    // Soja fija SIEMPRE. Extras incluidos segÃºn tamaÃ±o:
    // 10: 1 a elecciÃ³n
    // 15: 1 a elecciÃ³n
    // 20: 1 a elecciÃ³n
    // 30: 1 + 1 a elecciÃ³n
    // 40: 2 + 1 a elecciÃ³n
    // 50: 2 + 2 a elecciÃ³n
    const combos = [
      { id:"c10",  name:"Combo 10 piezas", pieces:10, price:16000, includesText:"Incluye: Soja fija + 1 salsa/adicional a elecciÃ³n." },
      { id:"c15",  name:"Combo 15 piezas", pieces:15, price:22000, includesText:"Incluye: Soja fija + 1 salsa/adicional a elecciÃ³n." },
      { id:"c20",  name:"Combo 20 piezas", pieces:20, price:28000, includesText:"Incluye: Soja fija + 1 salsa/adicional a elecciÃ³n." },
      { id:"c30",  name:"Combo 30 piezas", pieces:30, price:40000, includesText:"Incluye: Soja fija + 1 + 1 a elecciÃ³n." },
      { id:"c40",  name:"Combo 40 piezas", pieces:40, price:52000, includesText:"Incluye: Soja fija + 2 + 1 a elecciÃ³n." },
      { id:"c50",  name:"Combo 50 piezas", pieces:50, price:65000, includesText:"Incluye: Soja fija + 2 + 2 a elecciÃ³n." },
    ];

    // Salsas y Adicionales (van de a 1, NO suman piezas)
    const extras = [
      { id:"soja",   name:"Salsa de Soja", price:850,  type:"Salsa" },
      { id:"ba",     name:"Salsa Buenos Aires", price:1300, type:"Salsa" },
      { id:"mym",    name:"Salsa Mostaza y Miel", price:1300, type:"Salsa" },
      { id:"maracuya",name:"Salsa MaracuyÃ¡", price:1500, type:"Salsa" },
      { id:"guac",   name:"Guacamole", price:850, type:"Adicional" },
      { id:"criolla",name:"Criolla", price:750, type:"Adicional" },
      { id:"jengibre",name:"Jengibre", price:750, type:"Adicional" },
      { id:"pepino", name:"Pepino", price:700, type:"Adicional" },
    ];

    // ====== STATE ======
    let tab = "combos";
    // items de sushi (rolls y combos) -> { label, unitPrice, unitPieces, qty }
    const cartSushi = new Map();
    // extras (salsas/adicionales) -> { name, price, qty }
    const cartExtras = new Map();

    // ====== UI RENDER ======
    function setTab(next){
      tab = next;
      document.getElementById("tabCombos").classList.toggle("active", tab==="combos");
      document.getElementById("tabRolls").classList.toggle("active", tab==="rolls");
      document.getElementById("tabSalsas").classList.toggle("active", tab==="salsas");
      render();
    }

    function render(){
      const grid = document.getElementById("grid");
      const hint = document.getElementById("hint");
      grid.innerHTML = "";

      if(tab==="combos"){
        hint.innerHTML = `Soja incluida. Wasabi + pepino + jengibre incluidos. <b>Salsas extra segÃºn combo.</b>`;
        combos.forEach(c => grid.appendChild(comboCard(c)));
      }
      if(tab==="rolls"){
        hint.innerHTML = `Cada roll es <b>x5</b> piezas.`;
        rolls.forEach(r => grid.appendChild(rollCard(r)));
      }
      if(tab==="salsas"){
        hint.innerHTML = `Salsas y adicionales van <b>de a 1</b> (no suman piezas).`;
        extras.forEach(e => grid.appendChild(extraCard(e)));
      }

      updateTotals();
      updateExtrasLine();
    }

    function rollCard(r){
      const el = document.createElement("div");
      el.className = "card";
      el.innerHTML = `
        <div class="img-wrap" onclick="openImage('${escapeQuotes(r.img)}')">
          <span class="img-tag">Tocar para agrandar</span>
          <img src="${escapeQuotes(r.img)}" alt="${escapeQuotes(r.name)}"
               onerror="this.style.display='none'; this.parentElement.style.background='rgba(255,255,255,.05)';">
        </div>
        <div class="card-body">
          <h3>${escapeHtml(r.name)} <span class="price">$ ${formatNumber(r.price)}</span></h3>
          <p class="desc">${escapeHtml(r.desc)}</p>
          <div class="actions">
            <div class="badge">x5</div>
            <button class="btn" onclick="addSushi('${escapeQuotes(r.name)} x5', ${r.price}, ${r.pieces})">+ Agregar</button>
          </div>
        </div>
      `;
      return el;
    }

    function comboCard(c){
      const el = document.createElement("div");
      el.className = "card";
      el.innerHTML = `
        <div class="img-wrap" style="display:flex;align-items:center;justify-content:center;">
          <div style="text-align:center; padding:10px 12px;">
            <div style="font-size:22px; font-weight:1000; color:rgba(255,255,255,.85);">${c.pieces} piezas</div>
            <div style="margin-top:6px; font-size:18px; font-weight:1000; color:var(--gold);">Combo</div>
          </div>
        </div>
        <div class="card-body">
          <h3>${escapeHtml(c.name)} <span class="price">$ ${formatNumber(c.price)}</span></h3>
          <p class="desc">${escapeHtml(c.includesText)}</p>
          <div class="actions">
            <div class="badge">${c.pieces} piezas</div>
            <button class="btn" onclick="addSushi('${escapeQuotes(c.name)}', ${c.price}, ${c.pieces})">+ Agregar</button>
          </div>
        </div>
      `;
      return el;
    }

    function extraCard(e){
      const el = document.createElement("div");
      el.className = "card";
      el.innerHTML = `
        <div class="img-wrap" style="display:flex;align-items:center;justify-content:center;">
          <div style="text-align:center; padding:10px 12px;">
            <div style="font-size:16px; font-weight:1000; color:rgba(255,255,255,.85);">${escapeHtml(e.type)}</div>
            <div style="margin-top:6px; font-size:20px; font-weight:1000; color:var(--gold);">${escapeHtml(e.name)}</div>
          </div>
        </div>
        <div class="card-body">
          <h3>${escapeHtml(e.name)} <span class="price">$ ${formatNumber(e.price)}</span></h3>
          <p class="desc">Se suma al pedido (x1).</p>
          <div class="actions">
            <div class="badge">x1</div>
            <button class="btn" onclick="addExtra('${escapeQuotes(e.name)}', ${e.price})">+ Agregar</button>
          </div>
        </div>
      `;
      return el;
    }

    // ====== CART LOGIC ======
    function addSushi(label, unitPrice, unitPieces){
      const key = label;
      const current = cartSushi.get(key) || { label, unitPrice, unitPieces, qty:0 };
      current.qty += 1;
      cartSushi.set(key, current);
      toast("Agregado âœ…");
      updateTotals();
    }

    function addExtra(name, price){
      const current = cartExtras.get(name) || { name, price, qty:0 };
      current.qty += 1;
      cartExtras.set(name, current);
      toast("Agregado âœ…");
      updateTotals();
      updateExtrasLine();
    }

    function vaciar(){
      cartSushi.clear();
      cartExtras.clear();
      updateTotals();
      updateExtrasLine();
      toast("Vaciado âœ…");
    }

    function updateTotals(){
      let piezas = 0;
      let total = 0;

      cartSushi.forEach(it=>{
        piezas += it.unitPieces * it.qty;
        total  += it.unitPrice * it.qty;
      });
      cartExtras.forEach(ex=>{
        total += ex.price * ex.qty;
      });

      document.getElementById("totalPiezas").textContent = piezas;
      document.getElementById("totalPrice").textContent = "$ " + formatNumber(total);
    }

    function updateExtrasLine(){
      const el = document.getElementById("selectedExtras");
      if(cartExtras.size===0){
        el.textContent = "â€”";
        return;
      }
      const parts = [];
      cartExtras.forEach(ex=>{
        parts.push(`${ex.qty}x ${ex.name}`);
      });
      el.textContent = parts.join(" Â· ");
    }

    // ====== COPY MESSAGE (formato claro con x5 y piezas) ======
    function copiarPedido(){
      const sushiLines = [];
      let totalPiezas = 0;
      let total = 0;

      // Sushi
      cartSushi.forEach(it=>{
        const piezasItem = it.unitPieces * it.qty;
        totalPiezas += piezasItem;
        total += it.unitPrice * it.qty;

        // Si es roll (termina en x5) mostramos como pediste
        if(it.label.endsWith(" x5")){
          // ej: "2x Philadelphia x5 â€“ 10 piezas"
          const nombre = it.label.replace(" x5","");
          sushiLines.push(`${it.qty}x ${nombre} x5 â€“ ${piezasItem} piezas`);
        }else{
          // combo
          sushiLines.push(`${it.qty}x ${it.label} â€“ ${piezasItem} piezas`);
        }
      });

      // Extras
      const extraLines = [];
      cartExtras.forEach(ex=>{
        extraLines.push(`${ex.qty}x ${ex.name}`);
        total += ex.price * ex.qty;
      });

      const header = `Hola Stella Maris Sushi ðŸ£\n\nQuiero pedir:\n\n`;
      const sushiBlock = `ðŸ£ Sushi:\n${(sushiLines.length? sushiLines : ["(sin sushi)"]).map(s=>"â€¢ "+s).join("\n")}\n\n`;
      const extrasBlock = `ðŸ¥£ Salsas y adicionales:\n${(extraLines.length? extraLines : ["(sin extras)"]).map(s=>"â€¢ "+s).join("\n")}\n\n`;
      const totalsBlock = `Total de piezas: ${totalPiezas}\nTotal: $ ${formatNumber(total)}\n\nRetiro en el local.`;

      const msg = header + sushiBlock + extrasBlock + totalsBlock;

      navigator.clipboard.writeText(msg).then(()=>{
        toast("Copiado âœ…");
      }).catch(()=>{
        // fallback iOS viejo
        const ta = document.createElement("textarea");
        ta.value = msg;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand("copy");
        document.body.removeChild(ta);
        toast("Copiado âœ…");
      });
    }

    // ====== IMAGE MODAL ======
    function openImage(src){
      const img = document.getElementById("modalImg");
      img.src = src;
      document.getElementById("imageModal").style.display = "flex";
    }
    function closeImage(){
      document.getElementById("imageModal").style.display = "none";
    }

    // ====== HELPERS ======
    function formatNumber(n){
      return (n||0).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
    }
    function toast(text){
      const t = document.getElementById("toast");
      t.textContent = text;
      t.style.display = "block";
      clearTimeout(window.__toastTimer);
      window.__toastTimer = setTimeout(()=>t.style.display="none", 900);
    }
    function escapeHtml(s){
      return String(s).replace(/[&<>"']/g, m => ({
        "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
      }[m]));
    }
    function escapeQuotes(s){
      return String(s).replace(/'/g, "\\'");
    }

    // Init
    render();
  </script>
</body>
</html>
